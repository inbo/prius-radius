# Introduction

This figure in the report shows the number of unique grid cells occupied by the species in Flanders. It is based on output regarding the distribution maps (cubeBased_distribution_maps.Rmd).

Note: the data is not fully correct for 'invasieve duizendknopen'. The unique cells should have been calculated after having grouped the respective taxa. Now, grid cells may have been double-counted. Since it ends up at the same rank (coming up 3rd), the error is neglected here.

# Libraries

```{r}
library(tidyverse)
library(ggplot2)
library(INBOtheme)
```

# Data

```{r}
data <- read.csv("./data/output/distribution_maps/cells_per_species.csv", sep = ";")

# Manipulation
data$Soort[data$Soort == 'Aziatische hoornaar (soort)'] <- 'Aziatische hoornaar'
```

# Omit sporadic species

According to report structure, the graph only pertains to "present" species, and not "sporadic" species.

```{r}

spor <- c("Amerikaanse nerts",
          "Amerikaanse voseekhoorn",
          "Aziatische boomwurger",
          "Aziatische tijgermug",
          "Californische rivierkreeft",
          "gewone gunnera",
          "grijze eekhoorn",
          "heilige ibis",
          "Noord-Aziatische modderkruiper",
          "Pallas' eekhoorn",
          "treurmaina",
          "wasbeerhond",
          "waterhyacint",
          "watersla",
          "waterwaaier")

data <- data %>% 
  filter(!Soort %in% spor) %>% 
  arrange(Soort)
```


# Plot

```{r}
ggplot(data, aes(x = reorder(Soort, unique_cells, sum), y = unique_cells)) +
  geom_col(colour = "#c04384", fill = "#c04384") +
  theme_bw() +
  xlab("") + ylab("# cellen (1-kmÂ²)") +
  theme(axis.text = element_text(size = 9),
        axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
        axis.title = element_text(size = 9))

ggsave(filename = "./data/output/figures_for_report/grid_cells_species.jpeg",
           width = 14, height = 14, units = "cm")
```

